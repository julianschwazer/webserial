<!doctype html>

<html lang="en">
<head>
    <!-- Basics -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Web Serial Demo</title>

    <!-- Javascript - Simple Serial -->
    <script lang="text/javascript" src="js/simple-serial.min.js"></script>
</head>

<body>
    <main>
        <!-- connect button -->
        <button id="permissionElement">Connect Serial Port</button>

        <button onclick="toggleLED()">Toggle</button>

    </main>    

    <!-- Javascript â€“ Simple Serial Functions -->
    <script type="text/javascript">

        /* variables */
        let toggle = false;
        var baud = 57600;

        /* CHANGE IDS HERE */
        var cdID = 1; // Communication Design ID
        var mdID = 2; // Media Design ID
        var sdID = 3; // Sound Design ID
        var idID = 4; // Interaction Design ID
        var sensorRelease = 5; // Additional Value when you release the sensor
        
        /* connect button IN */
        const connection = SimpleSerial.connect({
            baudRate: baud, // baud settings for the serial connection
            requestButton: "permissionElement", // link to the id of the button that needs to be clicked
            requestAccessOnPageLoad: false, // if true - it will change to a modal instead of a normal button with the some functionality
        })


        /* listening to events from the arduino */
        connection.on('value', function(data) {

            // output of received data
            //console.log('Received value from arduino is: ' + data)

            if(data == cdID) {
                console.log('The Major Communication Design has an ID of ' + cdID)
            }
            else if(data == mdID) {
                console.log('The Major Media Design has an ID of ' + mdID)
            }
            else if(data == sdID) {
                console.log('The Major Sound Design has an ID of ' + sdID)
            }
            else if(data == idID) {
                console.log('The Major Interaction Design has an ID of ' + idID)
            }

            
        });

    
        


        /* sending events */
        connection.send('event-with-string', "Hello there, Arduino");

        connection.send('event-with-number', 123);

        connection.send('event-with-array', [42, "Nice string"]);

        connection.send('event-with-object', { r: 255, g: 255, b: 255 });

        
        /* toggle */
        function toggleLED() {
            const byte = (toggle = !toggle) ? 0 : 1
            connection.sendEvent('led', byte);
        }

    </script>

    </body>
</html>